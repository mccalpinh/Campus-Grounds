<!DOCTYPE html>
<html lang="en">
<head>



  <meta charset="UTF-8">
  <title>Manage Inventory</title>



      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
      <style>
        body {
          /*height: 800px;*/
      /*    background-size: cover;
          background: blue; /* For browsers that do not support gradients */
    /*      background: -webkit-linear-gradient(left top, yellow, brown); /* For Safari 5.1 to 6.0 */
    /*      background: -o-linear-gradient(bottom right, blue, yellow); /* For Opera 11.1 to 12.0 */
      /*    background: -moz-linear-gradient(bottom right, blue, yellow); /* For Firefox 3.6 to 15 */
      /*    background: linear-gradient(#efefef, gray); /* Standard syntax (must be last) */
          background-color: #fff;
          padding: 60px;
        }

        #nav {
          background-color: #59B2E0;
          color: black;
        }
        .nav.navbar-nav li a {
          color: black;
          font-family: "Avant Garde", Avantgarde, "Century Gothic", CenturyGothic, AppleGothic, sans-serif;
          text-transform: uppercase;
        }

        .navbar-header h {
          color: black;
          font-family: "Avant Garde", Avantgarde, "Century Gothic", CenturyGothic, AppleGothic, sans-serif;
        }

        .navbar-header h:hover {
          color: white;
        }


        @font-face {
          font-family: "Avant Garde", Avantgarde, "Century Gothic", CenturyGothic, AppleGothic, sans-serif;
          /*src: url(sansation_light.woff);*/
        }

        input[type="display"] {
            width: 150px;
            display: inline-block;
            padding-left: 10px;
            padding-right: 10px;
            background: none;
            border: none;
          }

        select {
              width: 150px;
              display: inline-block;
              padding-top: 3px;
              padding-bottom: 3px;
              background: white;
              color: #474747;
              border: 1px solid #474747;
            }


        .hidden{
          height: 0px;
        }

        .display{
          height: auto;
        }
        #transit{
          height: auto;
          -webkit-transition: .2s; /* For Safari 3.1 to 6.0 */
            transition: 1s;
        }

        .b {
          border-bottom: 1px solid #59B2E0;
          margin-top: 10px;
          margin-bottom: 10px;
        }

        .bb {
          border-bottom: 1px solid #ccc;
          margin-top: 10px;
          margin-bottom: 10px;
        }

        .buttonbox{
          display: inline-block;
        float: right;
        }

        .addbox{
          display: inline-block;
          float: right;
          text-align: right;
          padding: 10px;
          background-color: #f9f9f9;
        }

        .head{
          display: inline-block;
          font-size: 24pt;
        }

        .labelcolumns{
          padding: 5px;
          text-transform: uppercase;
        }

      </style>
</head>
<body>
  <div class = "top">
  <div class = "head">Inventory</div>

  <div class = "addbox">
    <form action="/addInv" method="POST">
          <input type="text" placeholder="product name" name="productName">
          <input type="text" placeholder="quantity" name="quantity">
        <!--  <input type="text" placeholder="vendor" name="vendor"> -->

          <select placeholder="vendor" name="vendor">
            <option value="" selected>Select Vendor</option>
            <% for(var i=0; i<vendor.length; i++) {%>
            <option value="<%= vendor[i].vendorName %>" > <%= vendor[i].vendorName %> </option>
            <% } %>
          </select>
          <button type="submit">Add Product</button>
    </form>
  </div>
</div>

  <p>

<!-- here 'j' is a absolute/unique variable so it refers to the index of the product in the product collection-->
  <div class="Vendors">
     <% for(var i=0; i<vendor.length; i++) {%>
       <div class = "b"></div>
       <div id="item<%=i%>"> <!-- one line -->
         <input type = "button" id = <%= "b" + i %> onclick="Expand(<%= i %>)" value="+">
         <input type="display" name="vendorName" value="<%= vendor[i].vendorName %>" readonly>
         <div id = "transit">
         <div id = <%= i %> class="hidden">
         <ul class="Inventory">
           <!-- put a line for labelling columns -->
           <div class = "labelcolumns">
           <input type="display" value="Item" readonly>
           <input type="display" value="Quantity" readonly>
         </div>
            <% for(var j=0; j<inventory.length; j++) {%>
              <% if (inventory[j].vendor == vendor[i].vendorName ) { %>
                <div class = "bb"></div>
              <li id="item<%=j%>">
                <form id="<%= 'form'+j %>" action="/updateordelete" method="post">
                  <input type="hidden" name="num" value="<%= j %>">
                  <input type="hidden" name="vendor" value="<%= vendor[i].vendorName %>">
                  <input type="hidden" id="<%= "type" + j %>" value="update" name = "operationType">
                <input type="display" id="<%= 'productName'+j %>" name="productName" value="<%= inventory[j].productName %>" readonly>
                <input type="display" id="<%= 'quantity'+j %>" name="quantity" value="<%= inventory[j].quantity %>" readonly>
            <!--    <input type = "button" id = <%= "b" + i + "," + j %> onclick="Expand(<%= i +","+j %>)" value="edit">
                <input type = "button" id = <%= "b" + i + "," + j %> onclick="Delete(<%= i +","+j %>)" value="delete"> -->
                <div class = "buttonbox">
                <button type="button" id= <%= 'edit' + j %> onclick="edit(this)">Edit</button>
                <button type="button" id= <%= 'delete' + j %> onclick="deleteProduct(this)">Delete</button>
              </div>
              </form>
              </li>
            <% } %>
              <% } %>
            </ul>
          </div>
          </div>
       </div>
       <% } %>
       <div class = "b"></div>
     </div>





  <nav id= "nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <div id="navhead">
        <a class="navbar-brand" href="#"><h>Campus Grounds Inventory Manager</h></a>
      </div>
      </div>
      <ul class="nav navbar-nav navbar-right">
        <li class="active"><a href="/manageInv">Manage Inventory</a></li>
        <li><a href="/manageVen">Manage Vendors</a></li>

</body>
</html>

<script>
  function Expand(i){
    var c = 0;
    var index = i;
    var s = document.getElementById(index);
    //if(c % 2 == 0){
      s.className = "display";
    //}
    document.getElementById("b" + i).value = "â€“";
    document.getElementById("b" + i).onclick = function() { Close(i); };

  }

  function Close(i){
      var index = i;
      var s = document.getElementById(index);
      s.className = "hidden";
      document.getElementById("b" + i).value = "+";
      document.getElementById("b" + i).onclick = function() { Expand(i); };
    }


  var content = [];

    function edit(button) {
          // get the number in the button id. It matches the number in the id of the
          // input element we need
          var rownum = button.id.match(/\d+/)[0];  // Extract the number from string 'editNUM'
          var type = document.getElementById('type'+rownum);
        //  type.value = "edit";
          var productInput = document.getElementById('productName'+rownum);
          var quantityInput = document.getElementById('quantity'+rownum);
          if (button.innerHTML == "Done") {
            productInput.readOnly = true;
            quantityInput.readOnly = true;
            // if the content was edited then update the database
            if (content[rownum].product != productInput.value || content[rownum].quantity != quantityInput.value) {
              var form = document.getElementById('form'+rownum);
              form.submit();
              console.log('submitted form');
            }
            productInput.style.background = "none";
            quantityInput.style.background = "none";
            button.innerHTML = "Edit";
          }
          else {
            // get the content of titleInput and ratingInput
            content[rownum] = {product: productInput.value, quantity: quantityInput.value};
            console.log(content[rownum]);
            // make this input element editable
            productInput.readOnly = false;
            quantityInput.readOnly = false;
            productInput.style.backgroundColor = "yellow";
            quantityInput.style.backgroundColor = "yellow";
            button.innerHTML = "Done";
          }
};

  function deleteProduct(button){
    var p = confirm("Are you sure?");
    if (p){
    var rownum = button.id.match(/\d+/)[0];  // Extract the number from string 'editNUM'
    var type = document.getElementById('type'+rownum);
    type.value = "delete";
    var form = document.getElementById('form'+rownum);
    form.submit();
    console.log('submitted form');
  }
  }

</script>
